(self.webpackChunk=self.webpackChunk||[]).push([[3224],{3224:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>i});var t=s(5166),a={class:"bg-gray-400 px-4 py-8 sm:p-4"},o={class:"mb-6 mt-2 flex justify-between items-center"},n={class:"flex justify-between"},l={class:"flex"};const c={metaInfo:{title:"Houses"},layout:function(e,r){return e(Layout,[e(Show,{props:{}},[r])])},components:{Gravatar,SendMessage,SearchInput,ReceivingMessageCard},props:{messages:Array,filters:Object},data:function(){return{replayMessage:null,form:{search:this.filters.search},errors:[]}},mounted:function(){var e=this,r=this.$page.auth.user.id;window.Echo.private("App.User."+r).notification((function(s){console.log("IDDDDDDDD",r),e.$inertia.reload()})),this.$emit("pageMounted")},watch:{form:{handler:_.throttle((function(){var e=_.pickBy(this.form);this.$inertia.replace(this.route("messages.received_messages.index",Object.keys(e).length?e:{remember:"forget"}))}),150),deep:!0}},methods:{replayClicked:function(e){this.messages.map((function(e){return e.replay=!1})),e.replay=!0},markAsRead:function(e){this.$inertia.post(this.route("messages.mark.notification"),{id:e?e.id:null},{replace:!1,preserveScroll:!0,preserveState:!0}).then((function(){console.log("message")}))},deleteMessage:function(e){this.$inertia.post(this.route("messages.delete.received"),{id:e.id},{replace:!1,preserveScroll:!0,preserveState:!0}).then((function(){console.log("message deleted")}))},reset:function(){this.form=_.mapValues(this.form,(function(){return null}))},cancel:function(e){e.replay=!1,this.replayMessage=null,this.errors=[]},sendMessage:function(e){var r=this;this.$inertia.post(this.route("messages.users.rooms.sendmessage.store",[e.data.sender_id,e.data.room_id]),{message:this.replayMessage,redirect:"messages.received_messages.index",id:e.id},{replace:!1,preserveScroll:!0,preserveState:!0}).then((function(){r.$page.errors.message?r.errors=r.$page.errors.message:e.replay=!1}))}},render:function(e,r,s,c,i,u){var d=(0,t.resolveComponent)("search-input"),m=(0,t.resolveComponent)("send-message"),p=(0,t.resolveComponent)("receiving-message-card");return(0,t.openBlock)(),(0,t.createBlock)("div",a,[(0,t.createVNode)("div",o,[(0,t.createVNode)(d,{modelValue:i.form.search,"onUpdate:modelValue":r[1]||(r[1]=function(e){return i.form.search=e}),class:"w-full max-w-sm mr-4",onReset:u.reset},null,8,["modelValue","onReset"])]),(0,t.createVNode)("a",{class:"block mt-2 mb-4 cursor-pointer text-green-600 hover:text-orange font-semibold",onClick:r[2]||(r[2]=function(e){return u.markAsRead(null)}),"preserve-scroll":""},"Mark all messages as read"),((0,t.openBlock)(!0),(0,t.createBlock)(t.Fragment,null,(0,t.renderList)(s.messages,(function(e){return(0,t.openBlock)(),(0,t.createBlock)(p,{key:e.id,message:e,class:{"border-gray-600 border-2":!e.read_at}},{default:(0,t.withCtx)((function(){return[(0,t.createVNode)("div",n,[(0,t.createVNode)("a",{class:"block mt-2 mb-4 cursor-pointer text-blue-500 hover:text-orange font-semibold",onClick:function(r){return u.replayClicked(e)}},"Replay",8,["onClick"]),(0,t.createVNode)("div",l,[e.read_at?(0,t.createCommentVNode)("",!0):((0,t.openBlock)(),(0,t.createBlock)("a",{key:0,class:"block mt-2 mb-4 cursor-pointer text-green-600 hover:text-orange font-semibold",onClick:function(r){return u.markAsRead(e)},"preserve-scroll":""},"Mark as read",8,["onClick"])),(0,t.createVNode)("a",{class:"block ml-2 mt-2 mb-4 cursor-pointer text-red-600 hover:text-orange font-semibold",onClick:function(r){return u.deleteMessage(e)},"preserve-scroll":""},"Delete",8,["onClick"])])]),e.replay?((0,t.openBlock)(),(0,t.createBlock)(m,{key:0,modelValue:i.replayMessage,"onUpdate:modelValue":r[3]||(r[3]=function(e){return i.replayMessage=e}),errors:i.errors,onSendMessage:function(r){return u.sendMessage(e)},onCancel:function(r){return u.cancel(e)}},null,8,["modelValue","errors","onSendMessage","onCancel"])):(0,t.createCommentVNode)("",!0)]})),_:2},1032,["message","class"])})),128))])}},i=c}}]);